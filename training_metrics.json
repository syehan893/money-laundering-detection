{
  "best_epoch": 36,
  "best_val_f1": 0.02502323340102571,
  "optimal_threshold": 0.9000000000000001,
  "test_metrics": {
    "precision": 0.9969558599695586,
    "recall": 0.8259773013871374,
    "f1": 0.903448275862069,
    "loss": 0.021003594622015953
  },
  "confusion_matrix": {
    "tn": 151769,
    "fp": 2,
    "fn": 138,
    "tp": 655
  },
  "risk_distribution": {
    "Low": 2192,
    "Moderate": 142184,
    "High": 7531,
    "Critical": 657
  },
  "hyperparameters": {
    "epochs_trained": 61,
    "lr": 0.0005,
    "weight_decay": 1e-05,
    "focal_alpha": 0.9,
    "focal_gamma": 2.0,
    "hidden_dim": 64,
    "num_heads": 4,
    "dropout": 0.3,
    "threshold": 0.9000000000000001,
    "oversample_ratio": 3.0
  },
  "training_history": [
    {
      "epoch": 1,
      "train_loss": 0.12064380943775177,
      "val_loss": 0.01873081550002098,
      "val_precision": 0.0011056093135772603,
      "val_recall": 0.14754098360655737,
      "val_f1": 0.0021947719406848814,
      "lr": 0.0004969282409784868,
      "time": 1.055295467376709,
      "vram_mb": 16.92041015625
    },
    {
      "epoch": 2,
      "train_loss": 0.11784464865922928,
      "val_loss": 0.01902000792324543,
      "val_precision": 0.004953310462492432,
      "val_recall": 0.6809583858764187,
      "val_f1": 0.00983508027428946,
      "lr": 0.00048778860081564085,
      "time": 0.5438427925109863,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 3,
      "train_loss": 0.08183134347200394,
      "val_loss": 0.019038066267967224,
      "val_precision": 0.005177695502640531,
      "val_recall": 0.694829760403531,
      "val_f1": 0.010278796019065208,
      "lr": 0.0004728061277849978,
      "time": 0.4991753101348877,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 4,
      "train_loss": 0.079336017370224,
      "val_loss": 0.019232211634516716,
      "val_precision": 0.007505059038487986,
      "val_recall": 0.9634300126103404,
      "val_f1": 0.014894094023842248,
      "lr": 0.0004523497400965494,
      "time": 0.5060696601867676,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 5,
      "train_loss": 0.05467792972922325,
      "val_loss": 0.01941606029868126,
      "val_precision": 0.008027769419249452,
      "val_recall": 0.9419924337957125,
      "val_f1": 0.015919867867227877,
      "lr": 0.0004269231419060436,
      "time": 0.5163600444793701,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 6,
      "train_loss": 0.044244810938835144,
      "val_loss": 0.01967276632785797,
      "val_precision": 0.00843183788964447,
      "val_recall": 0.9319041614123581,
      "val_f1": 0.016712461978583625,
      "lr": 0.00039715242044697206,
      "time": 0.5282139778137207,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 7,
      "train_loss": NaN,
      "val_loss": 0.019862473011016846,
      "val_precision": 0.008342081795297279,
      "val_recall": 0.9319041614123581,
      "val_f1": 0.016536137838442603,
      "lr": 0.00036377062968501693,
      "time": 0.5179812908172607,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 8,
      "train_loss": 0.03658539056777954,
      "val_loss": 0.019908122718334198,
      "val_precision": 0.008971189386336377,
      "val_recall": 0.9243379571248423,
      "val_f1": 0.01776991236257409,
      "lr": 0.0003275997400965494,
      "time": 0.5106334686279297,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 9,
      "train_loss": 0.035058390349149704,
      "val_loss": 0.02004365436732769,
      "val_precision": 0.009332477535301668,
      "val_recall": 0.9167717528373266,
      "val_f1": 0.01847686579492458,
      "lr": 0.00028953039902753766,
      "time": 0.5099756717681885,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 10,
      "train_loss": 0.03331567719578743,
      "val_loss": 0.02022012323141098,
      "val_precision": 0.009621406964192909,
      "val_recall": 0.9104665825977302,
      "val_f1": 0.019041590843157423,
      "lr": 0.0002505,
      "time": 0.5124373435974121,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 11,
      "train_loss": 0.0291464701294899,
      "val_loss": 0.020171262323856354,
      "val_precision": 0.01010597925392854,
      "val_recall": 0.9066834804539723,
      "val_f1": 0.019989157480643324,
      "lr": 0.00021146960097246246,
      "time": 0.629478931427002,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 12,
      "train_loss": 0.0298866406083107,
      "val_loss": 0.020300844684243202,
      "val_precision": 0.010338926994808968,
      "val_recall": 0.9066834804539723,
      "val_f1": 0.02044472247497725,
      "lr": 0.00017340025990345064,
      "time": 0.5012607574462891,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 13,
      "train_loss": 0.029309576377272606,
      "val_loss": 0.020514925941824913,
      "val_precision": 0.010437505436200749,
      "val_recall": 0.9079445145018915,
      "val_f1": 0.020637764242207094,
      "lr": 0.00013722937031498307,
      "time": 0.4978015422821045,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 14,
      "train_loss": 0.02935229241847992,
      "val_loss": 0.020629245787858963,
      "val_precision": 0.010557029955572499,
      "val_recall": 0.9079445145018915,
      "val_f1": 0.020871380120010434,
      "lr": 0.00010384757955302797,
      "time": 0.4978194236755371,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 15,
      "train_loss": 0.029096774756908417,
      "val_loss": 0.020614266395568848,
      "val_precision": 0.010782520020395309,
      "val_recall": 0.9066834804539723,
      "val_f1": 0.0213115968877362,
      "lr": 7.40768580939564e-05,
      "time": 0.49507594108581543,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 16,
      "train_loss": NaN,
      "val_loss": 0.020764019340276718,
      "val_precision": 0.010779249943858073,
      "val_recall": 0.9079445145018915,
      "val_f1": 0.021305557199502872,
      "lr": 4.865025990345063e-05,
      "time": 0.5000741481781006,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 17,
      "train_loss": 0.02855992503464222,
      "val_loss": 0.02079581841826439,
      "val_precision": 0.010893774336752473,
      "val_recall": 0.9066834804539723,
      "val_f1": 0.02152887983950654,
      "lr": 2.8193872215002235e-05,
      "time": 0.49808239936828613,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 18,
      "train_loss": 0.02941649965941906,
      "val_loss": 0.020795712247490883,
      "val_precision": 0.01102715321292542,
      "val_recall": 0.905422446406053,
      "val_f1": 0.02178893862377665,
      "lr": 1.3211399184359193e-05,
      "time": 0.49764108657836914,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 19,
      "train_loss": 0.027347004041075706,
      "val_loss": 0.020786527544260025,
      "val_precision": 0.011164572336151726,
      "val_recall": 0.9041614123581336,
      "val_f1": 0.02205678776878826,
      "lr": 4.071759021513154e-06,
      "time": 0.4971740245819092,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 20,
      "train_loss": 0.02700667642056942,
      "val_loss": 0.02068537101149559,
      "val_precision": 0.011372648542334168,
      "val_recall": 0.9041614123581336,
      "val_f1": 0.02246275787528,
      "lr": 0.0005,
      "time": 0.5022649765014648,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 21,
      "train_loss": NaN,
      "val_loss": 0.02059650793671608,
      "val_precision": 0.011558544431691428,
      "val_recall": 0.9016393442622951,
      "val_f1": 0.0228244908382813,
      "lr": 0.0004992308747664155,
      "time": 0.6145548820495605,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 22,
      "train_loss": NaN,
      "val_loss": 0.020624756813049316,
      "val_precision": 0.01164817620513823,
      "val_recall": 0.9016393442622951,
      "val_f1": 0.022999227997941327,
      "lr": 0.0004969282409784868,
      "time": 0.49668240547180176,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 23,
      "train_loss": 0.027555139735341072,
      "val_loss": 0.020403599366545677,
      "val_precision": 0.012225063938618925,
      "val_recall": 0.9041614123581336,
      "val_f1": 0.024123950675436972,
      "lr": 0.0004931062951392203,
      "time": 0.49590396881103516,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 24,
      "train_loss": NaN,
      "val_loss": 0.02054661139845848,
      "val_precision": 0.012159755787331469,
      "val_recall": 0.9041614123581336,
      "val_f1": 0.023996787041065632,
      "lr": 0.00048778860081564085,
      "time": 0.49036073684692383,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 25,
      "train_loss": 0.027164602652192116,
      "val_loss": 0.020407067611813545,
      "val_precision": 0.012519589064948633,
      "val_recall": 0.9066834804539723,
      "val_f1": 0.024698143345413325,
      "lr": 0.00048100794336156604,
      "time": 0.4902064800262451,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 26,
      "train_loss": 0.025937238708138466,
      "val_loss": 0.020530208945274353,
      "val_precision": 0.01256132781238039,
      "val_recall": 0.9104665825977302,
      "val_f1": 0.024780765732525613,
      "lr": 0.0004728061277849978,
      "time": 0.5041027069091797,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 27,
      "train_loss": 0.026172060519456863,
      "val_loss": 0.020569659769535065,
      "val_precision": 0.012588581477547751,
      "val_recall": 0.9117276166456494,
      "val_f1": 0.02483426647889259,
      "lr": 0.000463233721006346,
      "time": 0.4890782833099365,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 28,
      "train_loss": NaN,
      "val_loss": 0.020842095836997032,
      "val_precision": 0.012393519862066611,
      "val_recall": 0.9155107187894073,
      "val_f1": 0.02445597251229536,
      "lr": 0.0004523497400965494,
      "time": 0.4876723289489746,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 29,
      "train_loss": 0.024817200377583504,
      "val_loss": 0.020865987986326218,
      "val_precision": 0.012426288351422956,
      "val_recall": 0.9167717528373266,
      "val_f1": 0.024520219906236297,
      "lr": 0.00044022128841720773,
      "time": 0.4909932613372803,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 30,
      "train_loss": NaN,
      "val_loss": 0.020947711542248726,
      "val_precision": 0.012390707821314744,
      "val_recall": 0.9167717528373266,
      "val_f1": 0.02445094675949282,
      "lr": 0.0004269231419060436,
      "time": 0.4891386032104492,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 31,
      "train_loss": NaN,
      "val_loss": 0.021069785580039024,
      "val_precision": 0.012344840467983223,
      "val_recall": 0.9167717528373266,
      "val_f1": 0.024361637959922258,
      "lr": 0.0004125372880583809,
      "time": 0.607851505279541,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 32,
      "train_loss": NaN,
      "val_loss": 0.021164875477552414,
      "val_precision": 0.012332275957999015,
      "val_recall": 0.9167717528373266,
      "val_f1": 0.024337171933583288,
      "lr": 0.00039715242044697206,
      "time": 0.500248908996582,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 33,
      "train_loss": NaN,
      "val_loss": 0.0210823155939579,
      "val_precision": 0.012491838207498539,
      "val_recall": 0.9167717528373266,
      "val_f1": 0.02464782763472394,
      "lr": 0.00038086339189662925,
      "time": 0.49192333221435547,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 34,
      "train_loss": NaN,
      "val_loss": 0.021061064675450325,
      "val_precision": 0.01257611403265984,
      "val_recall": 0.9167717528373266,
      "val_f1": 0.02481186327878364,
      "lr": 0.00036377062968501693,
      "time": 0.4904026985168457,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 35,
      "train_loss": NaN,
      "val_loss": 0.021094389259815216,
      "val_precision": 0.01257872517129213,
      "val_recall": 0.9167717528373266,
      "val_f1": 0.024816945160354334,
      "lr": 0.00034597951637508993,
      "time": 0.4936554431915283,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 36,
      "train_loss": NaN,
      "val_loss": 0.02106574736535549,
      "val_precision": 0.012684731212813848,
      "val_recall": 0.9167717528373266,
      "val_f1": 0.02502323340102571,
      "lr": 0.0003275997400965494,
      "time": 0.5032665729522705,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 37,
      "train_loss": 0.024316908791661263,
      "val_loss": 0.021153239533305168,
      "val_precision": 0.012550278799178275,
      "val_recall": 0.9167717528373266,
      "val_f1": 0.02476158038147139,
      "lr": 0.00030874461828204845,
      "time": 0.48880648612976074,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 38,
      "train_loss": NaN,
      "val_loss": 0.021180758252739906,
      "val_precision": 0.012570677640793318,
      "val_recall": 0.9167717528373266,
      "val_f1": 0.02480128270733122,
      "lr": 0.00028953039902753766,
      "time": 0.49027109146118164,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 39,
      "train_loss": 0.02396111749112606,
      "val_loss": 0.02128281630575657,
      "val_precision": 0.012440990507353818,
      "val_recall": 0.9205548549810845,
      "val_f1": 0.02455019337481083,
      "lr": 0.00027007554438409736,
      "time": 0.49166321754455566,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 40,
      "train_loss": NaN,
      "val_loss": 0.0213211290538311,
      "val_precision": 0.012377706563575631,
      "val_recall": 0.9205548549810845,
      "val_f1": 0.024426970051865483,
      "lr": 0.0002505,
      "time": 0.49597740173339844,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 41,
      "train_loss": NaN,
      "val_loss": 0.0213625431060791,
      "val_precision": 0.01241201074574081,
      "val_recall": 0.9205548549810845,
      "val_f1": 0.024493767510527287,
      "lr": 0.0002309244556159027,
      "time": 0.6086325645446777,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 42,
      "train_loss": 0.023722006008028984,
      "val_loss": 0.021501285955309868,
      "val_precision": 0.012210154584221748,
      "val_recall": 0.9243379571248423,
      "val_f1": 0.024101931771475543,
      "lr": 0.00021146960097246246,
      "time": 0.49933576583862305,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 43,
      "train_loss": NaN,
      "val_loss": 0.021457672119140625,
      "val_precision": 0.012276617482037282,
      "val_recall": 0.9243379571248423,
      "val_f1": 0.024231404958677687,
      "lr": 0.0001922553817179516,
      "time": 0.4960293769836426,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 44,
      "train_loss": NaN,
      "val_loss": 0.021440977230668068,
      "val_precision": 0.012310844628071412,
      "val_recall": 0.9243379571248423,
      "val_f1": 0.024298074054430338,
      "lr": 0.00017340025990345064,
      "time": 0.4926624298095703,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 45,
      "train_loss": 0.024031944572925568,
      "val_loss": 0.021667618304491043,
      "val_precision": 0.012026083822131927,
      "val_recall": 0.9255989911727617,
      "val_f1": 0.023743671858573116,
      "lr": 0.0001550204836249101,
      "time": 0.48806238174438477,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 46,
      "train_loss": 0.02530137449502945,
      "val_loss": 0.021904077380895615,
      "val_precision": 0.011722488038277513,
      "val_recall": 0.926860025220681,
      "val_f1": 0.023152158505662043,
      "lr": 0.00013722937031498307,
      "time": 0.5061190128326416,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 47,
      "train_loss": 0.02383146993815899,
      "val_loss": 0.02205856703221798,
      "val_precision": 0.01149443214074051,
      "val_recall": 0.9293820933165196,
      "val_f1": 0.02270801559057787,
      "lr": 0.00012013660810337076,
      "time": 0.4904792308807373,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 48,
      "train_loss": NaN,
      "val_loss": 0.02204826846718788,
      "val_precision": 0.011584043255477666,
      "val_recall": 0.9293820933165196,
      "val_f1": 0.02288286889699604,
      "lr": 0.00010384757955302797,
      "time": 0.4975569248199463,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 49,
      "train_loss": NaN,
      "val_loss": 0.021911948919296265,
      "val_precision": 0.011709006561492144,
      "val_recall": 0.9293820933165196,
      "val_f1": 0.023126647420610016,
      "lr": 8.84627119416192e-05,
      "time": 0.49243807792663574,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 50,
      "train_loss": NaN,
      "val_loss": 0.021825112402439117,
      "val_precision": 0.011831275720164609,
      "val_recall": 0.9281210592686002,
      "val_f1": 0.02336470849669053,
      "lr": 7.40768580939564e-05,
      "time": 0.4937303066253662,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 51,
      "train_loss": NaN,
      "val_loss": 0.021634496748447418,
      "val_precision": 0.012052940983283524,
      "val_recall": 0.9255989911727617,
      "val_f1": 0.023796015626266393,
      "lr": 6.0778711582792276e-05,
      "time": 0.6129403114318848,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 52,
      "train_loss": 0.02393784560263157,
      "val_loss": 0.02168136090040207,
      "val_precision": 0.011922310595629567,
      "val_recall": 0.9281210592686002,
      "val_f1": 0.02354220644212008,
      "lr": 4.865025990345063e-05,
      "time": 0.49111270904541016,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 53,
      "train_loss": NaN,
      "val_loss": 0.021664181724190712,
      "val_precision": 0.01200431175279284,
      "val_recall": 0.926860025220681,
      "val_f1": 0.023701649441318265,
      "lr": 3.7766278993653996e-05,
      "time": 0.5008049011230469,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 54,
      "train_loss": NaN,
      "val_loss": 0.02178778499364853,
      "val_precision": 0.011932980485112186,
      "val_recall": 0.926860025220681,
      "val_f1": 0.023562601182938753,
      "lr": 2.8193872215002235e-05,
      "time": 0.4954240322113037,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 55,
      "train_loss": 0.023516636341810226,
      "val_loss": 0.02182609587907791,
      "val_precision": 0.011908228974533216,
      "val_recall": 0.9281210592686002,
      "val_f1": 0.02351475263183118,
      "lr": 1.9992056638433958e-05,
      "time": 0.4921762943267822,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 56,
      "train_loss": NaN,
      "val_loss": 0.02162867784500122,
      "val_precision": 0.01207415571383922,
      "val_recall": 0.9255989911727617,
      "val_f1": 0.02383736035333853,
      "lr": 1.3211399184359193e-05,
      "time": 0.5001235008239746,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 57,
      "train_loss": NaN,
      "val_loss": 0.021605342626571655,
      "val_precision": 0.012104820489140293,
      "val_recall": 0.9255989911727617,
      "val_f1": 0.0238971186716588,
      "lr": 7.893704860779699e-06,
      "time": 0.4959564208984375,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 58,
      "train_loss": 0.024965787306427956,
      "val_loss": 0.021621914580464363,
      "val_precision": 0.012031011817928502,
      "val_recall": 0.9255989911727617,
      "val_f1": 0.023753276592990518,
      "lr": 4.071759021513154e-06,
      "time": 0.49347901344299316,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 59,
      "train_loss": NaN,
      "val_loss": 0.021584348753094673,
      "val_precision": 0.012146284957802416,
      "val_recall": 0.9255989911727617,
      "val_f1": 0.023977916795975367,
      "lr": 1.769125233584573e-06,
      "time": 0.49454760551452637,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 60,
      "train_loss": NaN,
      "val_loss": 0.021547608077526093,
      "val_precision": 0.012194513300836813,
      "val_recall": 0.9243379571248423,
      "val_f1": 0.02407145906538373,
      "lr": 0.0005,
      "time": 0.4973578453063965,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 61,
      "train_loss": NaN,
      "val_loss": 0.021458402276039124,
      "val_precision": 0.012279291051026904,
      "val_recall": 0.9243379571248423,
      "val_f1": 0.024236612825896474,
      "lr": 0.0004998076445420604,
      "time": 0.6090223789215088,
      "vram_mb": 17.17626953125
    }
  ]
}
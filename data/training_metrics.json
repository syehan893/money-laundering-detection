{
  "best_epoch": 20,
  "best_val_f1": 0.07137112284505367,
  "optimal_threshold": 0.9000000000000001,
  "test_metrics": {
    "precision": 1.0,
    "recall": 0.893505253104107,
    "f1": 0.9437578814627995,
    "loss": 0.019677819684147835
  },
  "confusion_matrix": {
    "tn": 151746,
    "fp": 0,
    "fn": 223,
    "tp": 1871
  },
  "risk_distribution": {
    "Low": 0,
    "Moderate": 143296,
    "High": 8673,
    "Critical": 1871
  },
  "hyperparameters": {
    "epochs_trained": 60,
    "lr": 0.0005,
    "weight_decay": 1e-05,
    "focal_alpha": 0.9,
    "focal_gamma": 2.0,
    "hidden_dim": 64,
    "num_heads": 4,
    "dropout": 0.3,
    "threshold": 0.9000000000000001,
    "oversample_ratio": 5.0
  },
  "training_history": [
    {
      "epoch": 1,
      "train_loss": 0.09996073693037033,
      "val_loss": 0.018170572817325592,
      "val_precision": 0.03274786077333848,
      "val_recall": 0.9746290090952608,
      "val_f1": 0.06336658315307885,
      "lr": 0.0004969282409784868,
      "time": 1.262199878692627,
      "vram_mb": 17.1845703125
    },
    {
      "epoch": 2,
      "train_loss": 0.05551568791270256,
      "val_loss": 0.01912745274603367,
      "val_precision": 0.023774872218794024,
      "val_recall": 0.977501196744854,
      "val_f1": 0.04642069608311169,
      "lr": 0.00048778860081564085,
      "time": 0.5856523513793945,
      "vram_mb": 17.1845703125
    },
    {
      "epoch": 3,
      "train_loss": 0.038628339767456055,
      "val_loss": 0.020131772384047508,
      "val_precision": 0.02265264465743699,
      "val_recall": 0.977501196744854,
      "val_f1": 0.04427916255570132,
      "lr": 0.0004728061277849978,
      "time": 0.5854368209838867,
      "vram_mb": 17.1845703125
    },
    {
      "epoch": 4,
      "train_loss": 0.029474321752786636,
      "val_loss": 0.021157225593924522,
      "val_precision": 0.022889234452437155,
      "val_recall": 0.9794159885112494,
      "val_f1": 0.044733044733044736,
      "lr": 0.0004523497400965494,
      "time": 0.5791399478912354,
      "vram_mb": 17.1845703125
    },
    {
      "epoch": 5,
      "train_loss": 0.025128595530986786,
      "val_loss": 0.0217860359698534,
      "val_precision": 0.02418439716312057,
      "val_recall": 0.9794159885112494,
      "val_f1": 0.04720322070850973,
      "lr": 0.0004269231419060436,
      "time": 0.5813388824462891,
      "vram_mb": 17.1845703125
    },
    {
      "epoch": 6,
      "train_loss": 0.02315780147910118,
      "val_loss": 0.022314492613077164,
      "val_precision": 0.02534896705750977,
      "val_recall": 0.9779798946864529,
      "val_f1": 0.04941705771370519,
      "lr": 0.00039715242044697206,
      "time": 0.5820188522338867,
      "vram_mb": 17.1845703125
    },
    {
      "epoch": 7,
      "train_loss": 0.021107424050569534,
      "val_loss": 0.022670859470963478,
      "val_precision": 0.026513529297255208,
      "val_recall": 0.9779798946864529,
      "val_f1": 0.0516274133225513,
      "lr": 0.00036377062968501693,
      "time": 0.6007614135742188,
      "vram_mb": 17.1845703125
    },
    {
      "epoch": 8,
      "train_loss": 0.02109549194574356,
      "val_loss": 0.022854240611195564,
      "val_precision": 0.027723847668182745,
      "val_recall": 0.977501196744854,
      "val_f1": 0.053918462188424165,
      "lr": 0.0003275997400965494,
      "time": 0.6054332256317139,
      "vram_mb": 17.1845703125
    },
    {
      "epoch": 9,
      "train_loss": 0.019421493634581566,
      "val_loss": 0.02276979200541973,
      "val_precision": 0.02913313930263083,
      "val_recall": 0.977501196744854,
      "val_f1": 0.05657998642301991,
      "lr": 0.00028953039902753766,
      "time": 0.6682498455047607,
      "vram_mb": 17.1845703125
    },
    {
      "epoch": 10,
      "train_loss": 0.019759824499487877,
      "val_loss": 0.02274058759212494,
      "val_precision": 0.030113996667109087,
      "val_recall": 0.977501196744854,
      "val_f1": 0.05842799507854302,
      "lr": 0.0002505,
      "time": 0.6397743225097656,
      "vram_mb": 17.1845703125
    },
    {
      "epoch": 11,
      "train_loss": 0.01968405209481716,
      "val_loss": 0.022560087963938713,
      "val_precision": 0.031170337805864663,
      "val_recall": 0.977501196744854,
      "val_f1": 0.06041420118343195,
      "lr": 0.00021146960097246246,
      "time": 0.7921042442321777,
      "vram_mb": 17.1845703125
    },
    {
      "epoch": 12,
      "train_loss": 0.018751492723822594,
      "val_loss": 0.02238343469798565,
      "val_precision": 0.03193053817271589,
      "val_recall": 0.9770224988032551,
      "val_f1": 0.061840052114105655,
      "lr": 0.00017340025990345064,
      "time": 0.6423423290252686,
      "vram_mb": 17.1845703125
    },
    {
      "epoch": 13,
      "train_loss": 0.0188080333173275,
      "val_loss": 0.022160574793815613,
      "val_precision": 0.0327020444786259,
      "val_recall": 0.9770224988032551,
      "val_f1": 0.06328584052960419,
      "lr": 0.00013722937031498307,
      "time": 0.585608720779419,
      "vram_mb": 17.1845703125
    },
    {
      "epoch": 14,
      "train_loss": 0.019655603915452957,
      "val_loss": 0.02205975353717804,
      "val_precision": 0.03324645707769995,
      "val_recall": 0.9770224988032551,
      "val_f1": 0.06430473069834118,
      "lr": 0.00010384757955302797,
      "time": 0.5878944396972656,
      "vram_mb": 17.1845703125
    },
    {
      "epoch": 15,
      "train_loss": 0.01946829818189144,
      "val_loss": 0.021737024188041687,
      "val_precision": 0.0340609458963319,
      "val_recall": 0.9770224988032551,
      "val_f1": 0.06582703068810372,
      "lr": 7.40768580939564e-05,
      "time": 0.5798625946044922,
      "vram_mb": 17.1845703125
    },
    {
      "epoch": 16,
      "train_loss": 0.019238142296671867,
      "val_loss": 0.02155003510415554,
      "val_precision": 0.03460143084799783,
      "val_recall": 0.9770224988032551,
      "val_f1": 0.06683585755218993,
      "lr": 4.865025990345063e-05,
      "time": 0.5990762710571289,
      "vram_mb": 17.1845703125
    },
    {
      "epoch": 17,
      "train_loss": 0.01946743205189705,
      "val_loss": 0.021379562094807625,
      "val_precision": 0.03517691870184933,
      "val_recall": 0.9770224988032551,
      "val_f1": 0.0679088338046914,
      "lr": 2.8193872215002235e-05,
      "time": 0.602123498916626,
      "vram_mb": 17.1845703125
    },
    {
      "epoch": 18,
      "train_loss": 0.01981782540678978,
      "val_loss": 0.02121656946837902,
      "val_precision": 0.035810787100396535,
      "val_recall": 0.9770224988032551,
      "val_f1": 0.06908924733002725,
      "lr": 1.3211399184359193e-05,
      "time": 0.5745992660522461,
      "vram_mb": 17.1845703125
    },
    {
      "epoch": 19,
      "train_loss": 0.018652930855751038,
      "val_loss": 0.021162230521440506,
      "val_precision": 0.036215554412051744,
      "val_recall": 0.9770224988032551,
      "val_f1": 0.06984224754474215,
      "lr": 4.071759021513154e-06,
      "time": 0.6864151954650879,
      "vram_mb": 17.1845703125
    },
    {
      "epoch": 20,
      "train_loss": 0.0185502041131258,
      "val_loss": 0.020912576466798782,
      "val_precision": 0.037038381272116866,
      "val_recall": 0.9770224988032551,
      "val_f1": 0.07137112284505367,
      "lr": 0.0005,
      "time": 0.672687292098999,
      "vram_mb": 17.1845703125
    },
    {
      "epoch": 21,
      "train_loss": 0.01869083195924759,
      "val_loss": 0.020899923518300056,
      "val_precision": 0.03619050996524576,
      "val_recall": 0.9770224988032551,
      "val_f1": 0.06979567410447123,
      "lr": 0.0004992308747664155,
      "time": 0.7782163619995117,
      "vram_mb": 17.1845703125
    },
    {
      "epoch": 22,
      "train_loss": 0.01871594600379467,
      "val_loss": 0.020879121497273445,
      "val_precision": 0.03570428941291722,
      "val_recall": 0.9770224988032551,
      "val_f1": 0.06889102661468617,
      "lr": 0.0004969282409784868,
      "time": 0.8115706443786621,
      "vram_mb": 17.1845703125
    },
    {
      "epoch": 23,
      "train_loss": 0.018478645011782646,
      "val_loss": 0.020839646458625793,
      "val_precision": 0.03523278496090041,
      "val_recall": 0.9770224988032551,
      "val_f1": 0.06801292945449698,
      "lr": 0.0004931062951392203,
      "time": 0.7249999046325684,
      "vram_mb": 17.1845703125
    },
    {
      "epoch": 24,
      "train_loss": 0.01734025776386261,
      "val_loss": 0.020783590152859688,
      "val_precision": 0.03471560756565519,
      "val_recall": 0.9770224988032551,
      "val_f1": 0.06704883296923507,
      "lr": 0.00048778860081564085,
      "time": 0.7139480113983154,
      "vram_mb": 17.1845703125
    },
    {
      "epoch": 25,
      "train_loss": 0.01786683313548565,
      "val_loss": 0.02100682072341442,
      "val_precision": 0.03397211095783403,
      "val_recall": 0.9784585926280517,
      "val_f1": 0.06566435363659727,
      "lr": 0.00048100794336156604,
      "time": 0.6783528327941895,
      "vram_mb": 17.1845703125
    },
    {
      "epoch": 26,
      "train_loss": 0.016768928617239,
      "val_loss": 0.02110149897634983,
      "val_precision": 0.03284694992607829,
      "val_recall": 0.9784585926280517,
      "val_f1": 0.0635601784909122,
      "lr": 0.0004728061277849978,
      "time": 0.5883102416992188,
      "vram_mb": 17.1845703125
    },
    {
      "epoch": 27,
      "train_loss": 0.01648542657494545,
      "val_loss": 0.021142255514860153,
      "val_precision": 0.03222201234101499,
      "val_recall": 0.9798946864528483,
      "val_f1": 0.062392367831507076,
      "lr": 0.000463233721006346,
      "time": 0.5807757377624512,
      "vram_mb": 17.1845703125
    },
    {
      "epoch": 28,
      "train_loss": 0.017517371103167534,
      "val_loss": 0.02120552957057953,
      "val_precision": 0.031629496236782566,
      "val_recall": 0.9837242699856391,
      "val_f1": 0.06128839844915002,
      "lr": 0.0004523497400965494,
      "time": 0.5821282863616943,
      "vram_mb": 17.1845703125
    },
    {
      "epoch": 29,
      "train_loss": 0.0164114348590374,
      "val_loss": 0.02133006602525711,
      "val_precision": 0.031044171853284185,
      "val_recall": 0.9837242699856391,
      "val_f1": 0.06018891410998023,
      "lr": 0.00044022128841720773,
      "time": 0.5939185619354248,
      "vram_mb": 17.1845703125
    },
    {
      "epoch": 30,
      "train_loss": 0.01589035429060459,
      "val_loss": 0.02145511284470558,
      "val_precision": 0.030461593193205065,
      "val_recall": 0.9837242699856391,
      "val_f1": 0.05909332719874624,
      "lr": 0.0004269231419060436,
      "time": 0.5797369480133057,
      "vram_mb": 17.1845703125
    },
    {
      "epoch": 31,
      "train_loss": 0.016467232257127762,
      "val_loss": 0.02152879908680916,
      "val_precision": 0.029964619035832325,
      "val_recall": 0.9851603638104356,
      "val_f1": 0.058160237388724036,
      "lr": 0.0004125372880583809,
      "time": 0.7099802494049072,
      "vram_mb": 17.1845703125
    },
    {
      "epoch": 32,
      "train_loss": 0.015723487362265587,
      "val_loss": 0.021595424041152,
      "val_precision": 0.02947956188703558,
      "val_recall": 0.9856390617520344,
      "val_f1": 0.05724692078850057,
      "lr": 0.00039715242044697206,
      "time": 0.5715734958648682,
      "vram_mb": 17.1845703125
    },
    {
      "epoch": 33,
      "train_loss": 0.015539045445621014,
      "val_loss": 0.021609442308545113,
      "val_precision": 0.02913033031335246,
      "val_recall": 0.9865964576352322,
      "val_f1": 0.05658978583196046,
      "lr": 0.00038086339189662925,
      "time": 0.5824007987976074,
      "vram_mb": 17.1845703125
    },
    {
      "epoch": 34,
      "train_loss": 0.016222486272454262,
      "val_loss": 0.02165827341377735,
      "val_precision": 0.02842131391692868,
      "val_recall": 0.9865964576352322,
      "val_f1": 0.05525098853964212,
      "lr": 0.00036377062968501693,
      "time": 0.5899789333343506,
      "vram_mb": 17.1845703125
    },
    {
      "epoch": 35,
      "train_loss": 0.016513938084244728,
      "val_loss": 0.02164534479379654,
      "val_precision": 0.027984086681421338,
      "val_recall": 0.9865964576352322,
      "val_f1": 0.05442446328131189,
      "lr": 0.00034597951637508993,
      "time": 0.5807759761810303,
      "vram_mb": 17.1845703125
    },
    {
      "epoch": 36,
      "train_loss": 0.015277594327926636,
      "val_loss": 0.021620379760861397,
      "val_precision": 0.027525508841284258,
      "val_recall": 0.9865964576352322,
      "val_f1": 0.05355681153771195,
      "lr": 0.0003275997400965494,
      "time": 0.5808358192443848,
      "vram_mb": 17.1845703125
    },
    {
      "epoch": 37,
      "train_loss": 0.01510266400873661,
      "val_loss": 0.021576441824436188,
      "val_precision": 0.026836819648246437,
      "val_recall": 0.9875538535184298,
      "val_f1": 0.05225364420410076,
      "lr": 0.00030874461828204845,
      "time": 0.5800302028656006,
      "vram_mb": 17.1845703125
    },
    {
      "epoch": 38,
      "train_loss": 0.015107564628124237,
      "val_loss": 0.021457180380821228,
      "val_precision": 0.02666339244171018,
      "val_recall": 0.9875538535184298,
      "val_f1": 0.05192484363398397,
      "lr": 0.00028953039902753766,
      "time": 0.5780658721923828,
      "vram_mb": 17.1845703125
    },
    {
      "epoch": 39,
      "train_loss": 0.015699977055191994,
      "val_loss": 0.02135007455945015,
      "val_precision": 0.026829141415455043,
      "val_recall": 0.9875538535184298,
      "val_f1": 0.052239089424306495,
      "lr": 0.00027007554438409736,
      "time": 0.6091089248657227,
      "vram_mb": 17.1845703125
    },
    {
      "epoch": 40,
      "train_loss": 0.015381086617708206,
      "val_loss": 0.021104244515299797,
      "val_precision": 0.027750874361043853,
      "val_recall": 0.9875538535184298,
      "val_f1": 0.053984744010781245,
      "lr": 0.0002505,
      "time": 0.6038818359375,
      "vram_mb": 17.1845703125
    },
    {
      "epoch": 41,
      "train_loss": 0.014765375293791294,
      "val_loss": 0.02089925855398178,
      "val_precision": 0.028390776097198117,
      "val_recall": 0.9865964576352322,
      "val_f1": 0.055193283612067004,
      "lr": 0.0002309244556159027,
      "time": 0.7338528633117676,
      "vram_mb": 17.1845703125
    },
    {
      "epoch": 42,
      "train_loss": 0.015127909369766712,
      "val_loss": 0.020849131047725677,
      "val_precision": 0.028641309634653066,
      "val_recall": 0.9865964576352322,
      "val_f1": 0.055666594641313745,
      "lr": 0.00021146960097246246,
      "time": 0.5822501182556152,
      "vram_mb": 17.1845703125
    },
    {
      "epoch": 43,
      "train_loss": 0.014996749348938465,
      "val_loss": 0.02071147784590721,
      "val_precision": 0.02942478191967791,
      "val_recall": 0.9865964576352322,
      "val_f1": 0.05714523373814673,
      "lr": 0.0001922553817179516,
      "time": 0.5801024436950684,
      "vram_mb": 17.1845703125
    },
    {
      "epoch": 44,
      "train_loss": 0.015093564987182617,
      "val_loss": 0.0205133855342865,
      "val_precision": 0.030506216696269982,
      "val_recall": 0.9865964576352322,
      "val_f1": 0.05918247211015234,
      "lr": 0.00017340025990345064,
      "time": 0.5809924602508545,
      "vram_mb": 17.1845703125
    },
    {
      "epoch": 45,
      "train_loss": 0.015113127417862415,
      "val_loss": 0.02038838528096676,
      "val_precision": 0.03125236932688371,
      "val_recall": 0.9865964576352322,
      "val_f1": 0.06058557234405315,
      "lr": 0.0001550204836249101,
      "time": 0.6529378890991211,
      "vram_mb": 17.1845703125
    },
    {
      "epoch": 46,
      "train_loss": 0.014655964449048042,
      "val_loss": 0.020360080525279045,
      "val_precision": 0.0313060120910168,
      "val_recall": 0.9865964576352322,
      "val_f1": 0.06068636544322247,
      "lr": 0.00013722937031498307,
      "time": 0.6532700061798096,
      "vram_mb": 17.1845703125
    },
    {
      "epoch": 47,
      "train_loss": 0.014811044558882713,
      "val_loss": 0.02025890350341797,
      "val_precision": 0.03191143454362468,
      "val_recall": 0.9865964576352322,
      "val_f1": 0.061823199448060716,
      "lr": 0.00012013660810337076,
      "time": 0.6452510356903076,
      "vram_mb": 17.1845703125
    },
    {
      "epoch": 48,
      "train_loss": 0.01475497055798769,
      "val_loss": 0.020191753283143044,
      "val_precision": 0.03228181191654658,
      "val_recall": 0.9865964576352322,
      "val_f1": 0.06251801070783977,
      "lr": 0.00010384757955302797,
      "time": 0.6048521995544434,
      "vram_mb": 17.1845703125
    },
    {
      "epoch": 49,
      "train_loss": 0.015887737274169922,
      "val_loss": 0.02002509869635105,
      "val_precision": 0.03331824501277118,
      "val_recall": 0.9865964576352322,
      "val_f1": 0.0644596306316168,
      "lr": 8.84627119416192e-05,
      "time": 0.5911366939544678,
      "vram_mb": 17.1845703125
    },
    {
      "epoch": 50,
      "train_loss": 0.01497906818985939,
      "val_loss": 0.02006036974489689,
      "val_precision": 0.03323014414240108,
      "val_recall": 0.9865964576352322,
      "val_f1": 0.0642947388123723,
      "lr": 7.40768580939564e-05,
      "time": 0.6095602512359619,
      "vram_mb": 17.1845703125
    },
    {
      "epoch": 51,
      "train_loss": 0.015131187625229359,
      "val_loss": 0.019947873428463936,
      "val_precision": 0.033833475605752186,
      "val_recall": 0.9865964576352322,
      "val_f1": 0.06542337909689708,
      "lr": 6.0778711582792276e-05,
      "time": 0.7319788932800293,
      "vram_mb": 17.1845703125
    },
    {
      "epoch": 52,
      "train_loss": 0.014964678324759007,
      "val_loss": 0.019900459796190262,
      "val_precision": 0.034352290152676844,
      "val_recall": 0.9865964576352322,
      "val_f1": 0.06639284851413385,
      "lr": 4.865025990345063e-05,
      "time": 0.6032133102416992,
      "vram_mb": 17.1845703125
    },
    {
      "epoch": 53,
      "train_loss": 0.014989471063017845,
      "val_loss": 0.019866731017827988,
      "val_precision": 0.034761342553550345,
      "val_recall": 0.9865964576352322,
      "val_f1": 0.06715651933071572,
      "lr": 3.7766278993653996e-05,
      "time": 0.5893075466156006,
      "vram_mb": 17.1845703125
    },
    {
      "epoch": 54,
      "train_loss": 0.01451134867966175,
      "val_loss": 0.01975822262465954,
      "val_precision": 0.03518866313812532,
      "val_recall": 0.9865964576352322,
      "val_f1": 0.06795364249328212,
      "lr": 2.8193872215002235e-05,
      "time": 0.5682971477508545,
      "vram_mb": 17.1845703125
    },
    {
      "epoch": 55,
      "train_loss": 0.014497138559818268,
      "val_loss": 0.0197430606931448,
      "val_precision": 0.03543428925108314,
      "val_recall": 0.9865964576352322,
      "val_f1": 0.06841153137603107,
      "lr": 1.9992056638433958e-05,
      "time": 0.5735700130462646,
      "vram_mb": 17.1845703125
    },
    {
      "epoch": 56,
      "train_loss": 0.015819668769836426,
      "val_loss": 0.01970740593969822,
      "val_precision": 0.035876547078176405,
      "val_recall": 0.9865964576352322,
      "val_f1": 0.06923542058586402,
      "lr": 1.3211399184359193e-05,
      "time": 0.5825128555297852,
      "vram_mb": 17.1845703125
    },
    {
      "epoch": 57,
      "train_loss": 0.014891237951815128,
      "val_loss": 0.01973791979253292,
      "val_precision": 0.03539899007248119,
      "val_recall": 0.9865964576352322,
      "val_f1": 0.06834574124123294,
      "lr": 7.893704860779699e-06,
      "time": 0.6004555225372314,
      "vram_mb": 17.1845703125
    },
    {
      "epoch": 58,
      "train_loss": 0.01472526602447033,
      "val_loss": 0.019621022045612335,
      "val_precision": 0.0363107822410148,
      "val_recall": 0.9865964576352322,
      "val_f1": 0.07004367109041786,
      "lr": 4.071759021513154e-06,
      "time": 0.6057758331298828,
      "vram_mb": 17.1845703125
    },
    {
      "epoch": 59,
      "train_loss": 0.015506800264120102,
      "val_loss": 0.01967286691069603,
      "val_precision": 0.03597360888082106,
      "val_recall": 0.9865964576352322,
      "val_f1": 0.06941614321079133,
      "lr": 1.769125233584573e-06,
      "time": 0.6229593753814697,
      "vram_mb": 17.1845703125
    },
    {
      "epoch": 60,
      "train_loss": 0.014821311458945274,
      "val_loss": 0.019585954025387764,
      "val_precision": 0.036269247690277166,
      "val_recall": 0.9865964576352322,
      "val_f1": 0.06996639168958142,
      "lr": 0.0005,
      "time": 0.6121163368225098,
      "vram_mb": 17.1845703125
    }
  ]
}
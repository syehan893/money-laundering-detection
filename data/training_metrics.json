{
  "best_epoch": 33,
  "best_val_f1": 0.027055267380676942,
  "optimal_threshold": 0.9000000000000001,
  "test_metrics": {
    "precision": 0.9886914378029079,
    "recall": 0.7717528373266078,
    "f1": 0.8668555240793201,
    "loss": 0.018977385014295578
  },
  "confusion_matrix": {
    "tn": 151764,
    "fp": 7,
    "fn": 181,
    "tp": 612
  },
  "risk_distribution": {
    "Low": 6155,
    "Moderate": 139334,
    "High": 6456,
    "Critical": 619
  },
  "hyperparameters": {
    "epochs_trained": 58,
    "lr": 0.0005,
    "weight_decay": 1e-05,
    "focal_alpha": 0.9,
    "focal_gamma": 2.0,
    "hidden_dim": 64,
    "num_heads": 4,
    "dropout": 0.3,
    "threshold": 0.9000000000000001,
    "oversample_ratio": 3.0
  },
  "training_history": [
    {
      "epoch": 1,
      "train_loss": 0.11293046921491623,
      "val_loss": 0.017324544489383698,
      "val_precision": 0.012726789981414284,
      "val_recall": 0.9066834804539723,
      "val_f1": 0.02510124284317833,
      "lr": 0.0004969282409784868,
      "time": 0.9489157199859619,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 2,
      "train_loss": 0.0719313994050026,
      "val_loss": 0.018508143723011017,
      "val_precision": 0.008670725640235957,
      "val_recall": 0.9230769230769231,
      "val_f1": 0.017180073930646012,
      "lr": 0.00048778860081564085,
      "time": 0.4952852725982666,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 3,
      "train_loss": 0.052686214447021484,
      "val_loss": 0.0197377298027277,
      "val_precision": 0.007831646244006393,
      "val_recall": 0.926860025220681,
      "val_f1": 0.01553205202709128,
      "lr": 0.0004728061277849978,
      "time": 0.489332914352417,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 4,
      "train_loss": 0.04298355057835579,
      "val_loss": 0.02097312919795513,
      "val_precision": 0.007691985683487871,
      "val_recall": 0.926860025220681,
      "val_f1": 0.015257351033244418,
      "lr": 0.0004523497400965494,
      "time": 0.48653340339660645,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 5,
      "train_loss": NaN,
      "val_loss": 0.02153613790869713,
      "val_precision": 0.007539912695747733,
      "val_recall": 0.9344262295081968,
      "val_f1": 0.014959119814272736,
      "lr": 0.0004269231419060436,
      "time": 0.4839777946472168,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 6,
      "train_loss": 0.03808194398880005,
      "val_loss": 0.021912433207035065,
      "val_precision": 0.00812592403205905,
      "val_recall": 0.9218158890290038,
      "val_f1": 0.016109837799717912,
      "lr": 0.00039715242044697206,
      "time": 0.48630356788635254,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 7,
      "train_loss": 0.034114543348550797,
      "val_loss": 0.022105073556303978,
      "val_precision": 0.008668561304208235,
      "val_recall": 0.9192938209331651,
      "val_f1": 0.01717516786429497,
      "lr": 0.00036377062968501693,
      "time": 0.49130940437316895,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 8,
      "train_loss": 0.03280353173613548,
      "val_loss": 0.022196033969521523,
      "val_precision": 0.009085554594784264,
      "val_recall": 0.914249684741488,
      "val_f1": 0.01799230673780866,
      "lr": 0.0003275997400965494,
      "time": 0.4841728210449219,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 9,
      "train_loss": 0.03083151951432228,
      "val_loss": 0.022324083372950554,
      "val_precision": 0.00939167832530183,
      "val_recall": 0.914249684741488,
      "val_f1": 0.018592365590019106,
      "lr": 0.00028953039902753766,
      "time": 0.48621082305908203,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 10,
      "train_loss": NaN,
      "val_loss": 0.022415606305003166,
      "val_precision": 0.009419621396182779,
      "val_recall": 0.914249684741488,
      "val_f1": 0.018647119341563784,
      "lr": 0.0002505,
      "time": 0.48599910736083984,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 11,
      "train_loss": NaN,
      "val_loss": 0.022199885919690132,
      "val_precision": 0.009623458847050983,
      "val_recall": 0.9104665825977302,
      "val_f1": 0.019045609222084467,
      "lr": 0.00021146960097246246,
      "time": 0.6010103225708008,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 12,
      "train_loss": 0.030057989060878754,
      "val_loss": 0.02187458984553814,
      "val_precision": 0.010019037560968832,
      "val_recall": 0.9092055485498108,
      "val_f1": 0.019819671229864205,
      "lr": 0.00017340025990345064,
      "time": 0.4916555881500244,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 13,
      "train_loss": NaN,
      "val_loss": 0.02165939472615719,
      "val_precision": 0.010228725671260121,
      "val_recall": 0.9079445145018915,
      "val_f1": 0.020229549190115617,
      "lr": 0.00013722937031498307,
      "time": 0.4839322566986084,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 14,
      "train_loss": 0.029338324442505836,
      "val_loss": 0.021336287260055542,
      "val_precision": 0.010507495933291323,
      "val_recall": 0.9041614123581336,
      "val_f1": 0.020773576705780096,
      "lr": 0.00010384757955302797,
      "time": 0.48736000061035156,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 15,
      "train_loss": NaN,
      "val_loss": 0.02128501981496811,
      "val_precision": 0.010613225027051865,
      "val_recall": 0.9029003783102144,
      "val_f1": 0.020979840600093766,
      "lr": 7.40768580939564e-05,
      "time": 0.4953734874725342,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 16,
      "train_loss": 0.028905777260661125,
      "val_loss": 0.021047409623861313,
      "val_precision": 0.010879474867805264,
      "val_recall": 0.9029003783102144,
      "val_f1": 0.021499887395841154,
      "lr": 4.865025990345063e-05,
      "time": 0.49570488929748535,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 17,
      "train_loss": 0.030631929636001587,
      "val_loss": 0.020855754613876343,
      "val_precision": 0.011084106073037447,
      "val_recall": 0.9029003783102144,
      "val_f1": 0.021899372992812357,
      "lr": 2.8193872215002235e-05,
      "time": 0.5015332698822021,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 18,
      "train_loss": 0.029067635536193848,
      "val_loss": 0.02071186900138855,
      "val_precision": 0.011247957773030037,
      "val_recall": 0.9029003783102144,
      "val_f1": 0.022219118993312543,
      "lr": 1.3211399184359193e-05,
      "time": 0.48403048515319824,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 19,
      "train_loss": 0.028383728116750717,
      "val_loss": 0.020528092980384827,
      "val_precision": 0.011417347981604497,
      "val_recall": 0.9016393442622951,
      "val_f1": 0.022549158742923823,
      "lr": 4.071759021513154e-06,
      "time": 0.49199676513671875,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 20,
      "train_loss": 0.029506882652640343,
      "val_loss": 0.02039027214050293,
      "val_precision": 0.011568560734943858,
      "val_recall": 0.9003783102143758,
      "val_f1": 0.022843614026106986,
      "lr": 0.0005,
      "time": 0.48393726348876953,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 21,
      "train_loss": 0.030024541541934013,
      "val_loss": 0.01972430944442749,
      "val_precision": 0.01241664351208669,
      "val_recall": 0.9016393442622951,
      "val_f1": 0.024495948746938008,
      "lr": 0.0004992308747664155,
      "time": 0.6066012382507324,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 22,
      "train_loss": NaN,
      "val_loss": 0.01976276934146881,
      "val_precision": 0.012406171809841535,
      "val_recall": 0.9003783102143758,
      "val_f1": 0.024475104979004198,
      "lr": 0.0004969282409784868,
      "time": 0.4836289882659912,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 23,
      "train_loss": 0.029627228155732155,
      "val_loss": 0.019461456686258316,
      "val_precision": 0.01303738232669932,
      "val_recall": 0.9029003783102144,
      "val_f1": 0.025703618609994257,
      "lr": 0.0004931062951392203,
      "time": 0.4932131767272949,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 24,
      "train_loss": NaN,
      "val_loss": 0.019454937428236008,
      "val_precision": 0.013077147866744594,
      "val_recall": 0.9029003783102144,
      "val_f1": 0.02578089837069043,
      "lr": 0.00048778860081564085,
      "time": 0.49334144592285156,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 25,
      "train_loss": NaN,
      "val_loss": 0.019392427057027817,
      "val_precision": 0.013157894736842105,
      "val_recall": 0.9016393442622951,
      "val_f1": 0.025937278943645368,
      "lr": 0.00048100794336156604,
      "time": 0.4895515441894531,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 26,
      "train_loss": 0.027072474360466003,
      "val_loss": 0.019204821437597275,
      "val_precision": 0.013564942160593844,
      "val_recall": 0.9079445145018915,
      "val_f1": 0.02673052291585454,
      "lr": 0.0004728061277849978,
      "time": 0.4853644371032715,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 27,
      "train_loss": 0.026683825999498367,
      "val_loss": 0.019092638045549393,
      "val_precision": 0.013626755246866979,
      "val_recall": 0.9104665825977302,
      "val_f1": 0.026851628019413504,
      "lr": 0.000463233721006346,
      "time": 0.48452234268188477,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 28,
      "train_loss": NaN,
      "val_loss": 0.01911281980574131,
      "val_precision": 0.013648135195932025,
      "val_recall": 0.9104665825977302,
      "val_f1": 0.02689313517338995,
      "lr": 0.0004523497400965494,
      "time": 0.4840846061706543,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 29,
      "train_loss": NaN,
      "val_loss": 0.019189957529306412,
      "val_precision": 0.013610315186246419,
      "val_recall": 0.9104665825977302,
      "val_f1": 0.02681970988651771,
      "lr": 0.00044022128841720773,
      "time": 0.4956943988800049,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 30,
      "train_loss": NaN,
      "val_loss": 0.019162027165293694,
      "val_precision": 0.013669064748201438,
      "val_recall": 0.9104665825977302,
      "val_f1": 0.026933766064200847,
      "lr": 0.0004269231419060436,
      "time": 0.4887659549713135,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 31,
      "train_loss": 0.025631342083215714,
      "val_loss": 0.019124872982501984,
      "val_precision": 0.013593325208587232,
      "val_recall": 0.914249684741488,
      "val_f1": 0.02678835353236772,
      "lr": 0.0004125372880583809,
      "time": 0.6156833171844482,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 32,
      "train_loss": NaN,
      "val_loss": 0.019139455631375313,
      "val_precision": 0.013618092340057853,
      "val_recall": 0.914249684741488,
      "val_f1": 0.026836445744109864,
      "lr": 0.00039715242044697206,
      "time": 0.4936563968658447,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 33,
      "train_loss": NaN,
      "val_loss": 0.01906537637114525,
      "val_precision": 0.01373080055301983,
      "val_recall": 0.914249684741488,
      "val_f1": 0.027055267380676942,
      "lr": 0.00038086339189662925,
      "time": 0.5275125503540039,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 34,
      "train_loss": 0.027525782585144043,
      "val_loss": 0.01905704103410244,
      "val_precision": 0.013592124398702317,
      "val_recall": 0.9192938209331651,
      "val_f1": 0.026788174986679406,
      "lr": 0.00036377062968501693,
      "time": 0.502995491027832,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 35,
      "train_loss": NaN,
      "val_loss": 0.01904888264834881,
      "val_precision": 0.01365884733568163,
      "val_recall": 0.9192938209331651,
      "val_f1": 0.02691775131542509,
      "lr": 0.00034597951637508993,
      "time": 0.4978814125061035,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 36,
      "train_loss": NaN,
      "val_loss": 0.019006991758942604,
      "val_precision": 0.013724455169293416,
      "val_recall": 0.9180327868852459,
      "val_f1": 0.02704459758158887,
      "lr": 0.0003275997400965494,
      "time": 0.4893980026245117,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 37,
      "train_loss": NaN,
      "val_loss": 0.01907280460000038,
      "val_precision": 0.013698114627629548,
      "val_recall": 0.9180327868852459,
      "val_f1": 0.02699345557018113,
      "lr": 0.00030874461828204845,
      "time": 0.485210657119751,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 38,
      "train_loss": 0.024655470624566078,
      "val_loss": 0.01917272061109543,
      "val_precision": 0.013397287462785313,
      "val_recall": 0.9192938209331651,
      "val_f1": 0.026409694422808702,
      "lr": 0.00028953039902753766,
      "time": 0.48313355445861816,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 39,
      "train_loss": NaN,
      "val_loss": 0.01906297169625759,
      "val_precision": 0.01355799810299615,
      "val_recall": 0.9192938209331651,
      "val_f1": 0.026721894358711192,
      "lr": 0.00027007554438409736,
      "time": 0.4884028434753418,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 40,
      "train_loss": NaN,
      "val_loss": 0.019015150144696236,
      "val_precision": 0.013631009143434117,
      "val_recall": 0.9192938209331651,
      "val_f1": 0.02686369163872204,
      "lr": 0.0002505,
      "time": 0.48518848419189453,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 41,
      "train_loss": NaN,
      "val_loss": 0.018991980701684952,
      "val_precision": 0.013670373356836124,
      "val_recall": 0.9192938209331651,
      "val_f1": 0.026940133037694013,
      "lr": 0.0002309244556159027,
      "time": 0.6009042263031006,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 42,
      "train_loss": 0.026442090049386024,
      "val_loss": 0.01918880268931389,
      "val_precision": 0.013280865715691098,
      "val_recall": 0.9192938209331651,
      "val_f1": 0.026183463831621293,
      "lr": 0.00021146960097246246,
      "time": 0.4963357448577881,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 43,
      "train_loss": 0.024060828611254692,
      "val_loss": 0.01948125846683979,
      "val_precision": 0.012828826302599064,
      "val_recall": 0.9230769230769231,
      "val_f1": 0.02530595312175897,
      "lr": 0.0001922553817179516,
      "time": 0.49299049377441406,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 44,
      "train_loss": Infinity,
      "val_loss": 0.01951269432902336,
      "val_precision": 0.012812210106243328,
      "val_recall": 0.9230769230769231,
      "val_f1": 0.025273624969789042,
      "lr": 0.00017340025990345064,
      "time": 0.4833824634552002,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 45,
      "train_loss": 0.02428601309657097,
      "val_loss": 0.01970066875219345,
      "val_precision": 0.012520868113522538,
      "val_recall": 0.926860025220681,
      "val_f1": 0.024707958651987563,
      "lr": 0.0001550204836249101,
      "time": 0.48458147048950195,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 46,
      "train_loss": 0.02497982047498226,
      "val_loss": 0.019888747483491898,
      "val_precision": 0.01220422173213723,
      "val_recall": 0.9281210592686002,
      "val_f1": 0.02409165302782324,
      "lr": 0.00013722937031498307,
      "time": 0.4863564968109131,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 47,
      "train_loss": NaN,
      "val_loss": 0.019809210672974586,
      "val_precision": 0.012288376131165058,
      "val_recall": 0.9281210592686002,
      "val_f1": 0.02425560663733584,
      "lr": 0.00012013660810337076,
      "time": 0.49202823638916016,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 48,
      "train_loss": NaN,
      "val_loss": 0.019665071740746498,
      "val_precision": 0.012488530940972577,
      "val_recall": 0.926860025220681,
      "val_f1": 0.024644994718929704,
      "lr": 0.00010384757955302797,
      "time": 0.48234128952026367,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 49,
      "train_loss": NaN,
      "val_loss": 0.019505606964230537,
      "val_precision": 0.012687945588565312,
      "val_recall": 0.926860025220681,
      "val_f1": 0.025033207315827116,
      "lr": 8.84627119416192e-05,
      "time": 0.4841597080230713,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 50,
      "train_loss": NaN,
      "val_loss": 0.019551070407032967,
      "val_precision": 0.01263447801015578,
      "val_recall": 0.9255989911727617,
      "val_f1": 0.024928678168727077,
      "lr": 7.40768580939564e-05,
      "time": 0.48351240158081055,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 51,
      "train_loss": NaN,
      "val_loss": 0.019540537148714066,
      "val_precision": 0.012611250472492353,
      "val_recall": 0.9255989911727617,
      "val_f1": 0.024883464700398338,
      "lr": 6.0778711582792276e-05,
      "time": 0.5999641418457031,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 52,
      "train_loss": 0.023782210424542427,
      "val_loss": 0.0196441188454628,
      "val_precision": 0.012477688057798555,
      "val_recall": 0.9255989911727617,
      "val_f1": 0.02462343587507129,
      "lr": 4.865025990345063e-05,
      "time": 0.4859611988067627,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 53,
      "train_loss": 0.02417420968413353,
      "val_loss": 0.019556568935513496,
      "val_precision": 0.012521964617773001,
      "val_recall": 0.9255989911727617,
      "val_f1": 0.02470964484093587,
      "lr": 3.7766278993653996e-05,
      "time": 0.48546862602233887,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 54,
      "train_loss": 0.023991238325834274,
      "val_loss": 0.019566554576158524,
      "val_precision": 0.01252837660231792,
      "val_recall": 0.9255989911727617,
      "val_f1": 0.024722128662849445,
      "lr": 2.8193872215002235e-05,
      "time": 0.4851806163787842,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 55,
      "train_loss": NaN,
      "val_loss": 0.019446667283773422,
      "val_precision": 0.012699181646741293,
      "val_recall": 0.9255989911727617,
      "val_f1": 0.025054614964500274,
      "lr": 1.9992056638433958e-05,
      "time": 0.4857182502746582,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 56,
      "train_loss": 0.024978946894407272,
      "val_loss": 0.019491324201226234,
      "val_precision": 0.012639699677980403,
      "val_recall": 0.9255989911727617,
      "val_f1": 0.024938842076651264,
      "lr": 1.3211399184359193e-05,
      "time": 0.4893183708190918,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 57,
      "train_loss": NaN,
      "val_loss": 0.019476553425192833,
      "val_precision": 0.012680533480754612,
      "val_recall": 0.9255989911727617,
      "val_f1": 0.025018320636706035,
      "lr": 7.893704860779699e-06,
      "time": 0.4974207878112793,
      "vram_mb": 17.17626953125
    },
    {
      "epoch": 58,
      "train_loss": NaN,
      "val_loss": 0.019446978345513344,
      "val_precision": 0.01265757298798048,
      "val_recall": 0.9255989911727617,
      "val_f1": 0.024973631383756932,
      "lr": 4.071759021513154e-06,
      "time": 0.4873819351196289,
      "vram_mb": 17.17626953125
    }
  ]
}